---
import { Astro } from 'astro';

const lang = Astro.request.url.searchParams.get('lang') || 'ru';

const texts = {
  ru: {
    title: 'Предел петляной вечности',
    mainHeading: 'Новелла "Предел петляной вечности"',
    mainText: 'Погрузись в увлекательную историю, где события переплетаются во времени.',
    authorsHeading: 'Об авторах',
    downloadBtn: 'Скачать',
    platformAndroid: 'Андроид',
    platformMac: 'Mac',
    platformWin: 'Windows',
    footer: '© 2025 Предел петляной вечности',
  },
  uk: {
    title: 'Предел петляной вечності',
    mainHeading: 'Новела "Предел петляной вечності"',
    mainText: 'Поринь у захопливу історію, де події переплітаються у часі.',
    authorsHeading: 'Про авторів',
    downloadBtn: 'Скачати',
    platformAndroid: 'Андроїд',
    platformMac: 'Mac',
    platformWin: 'Windows',
    footer: '© 2025 Предел петляной вечності',
  },
  en: {
    title: 'Limit of the Eternal Loop',
    mainHeading: 'Novel "Limit of the Eternal Loop"',
    mainText: 'Dive into an exciting story where events intertwine in time.',
    authorsHeading: 'About Authors',
    downloadBtn: 'Download',
    platformAndroid: 'Android',
    platformMac: 'Mac',
    platformWin: 'Windows',
    footer: '© 2025 Limit of the Eternal Loop',
  },
  pl: {
    title: 'Próg wiecznej pętli',
    mainHeading: 'Nowela "Próg wiecznej pętli"',
    mainText: 'Zanurz się w fascynującą historię, gdzie wydarzenia splatają się w czasie.',
    authorsHeading: 'O autorach',
    downloadBtn: 'Pobierz',
    platformAndroid: 'Android',
    platformMac: 'Mac',
    platformWin: 'Windows',
    footer: '© 2025 Próg wiecznej pętli',
  }
}

const t = texts[lang];
---

<html lang={lang}>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{t.title}</title>
  <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      margin:0;
      font-family:'EB Garamond', serif;
      background: linear-gradient(135deg,#0f0c29,#302b63,#24243e);
      color:#fff;
      padding:40px 20px;
      text-align:center;
    }
    .lang-switch { position:absolute; top:20px; right:20px; display:flex; flex-direction:row-reverse; gap:10px; }
    .lang-switch a { padding:6px 10px; background:rgba(255,255,255,0.1); border-radius:8px; color:#fff; font-weight:bold; text-decoration:none; }
    .lang-switch a:hover { background: rgba(255,255,255,0.3); }
    h1 { font-size:3rem; margin-bottom:20px; text-shadow:2px 2px 10px rgba(0,0,0,0.7); }
    p { font-size:1.2rem; margin-bottom:40px; max-width:600px; margin-left:auto; margin-right:auto; }
    .top-buttons { display:flex; justify-content:center; gap:20px; flex-wrap:wrap; }
    .nav-btn, .download-btn {
      padding:15px 35px; font-size:18px; font-weight:bold; color:#fff; background: linear-gradient(135deg, rgba(255,106,0,0.8), rgba(255,140,66,0.8));
      border:none; border-radius:20px; cursor:pointer; text-decoration:none; transition:all 0.3s ease; box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }
    .download-section { display: none; margin-top:20px; justify-content:center; gap:15px; flex-wrap:wrap; }
    .download-section.show { display: flex; }
    footer { margin-top:50px; font-size:0.9rem; color:rgba(255,255,255,0.7); text-align:center; }
  </style>
</head>
<body>
  <div class="lang-switch">
    <a href="?lang=pl">PL</a>
    <a href="?lang=en">EN</a>
    <a href="?lang=uk">UA</a>
    <a href="?lang=ru">RU</a>
  </div>

  <h1>{t.mainHeading}</h1>
  <p>{t.mainText}</p>

  <div class="top-buttons">
    <a href="/authors?lang={lang}" class="nav-btn">{t.authorsHeading}</a>
    <button class="nav-btn" id="download-btn">{t.downloadBtn}</button>
  </div>

  <div id="download-section" class="download-section">
    <a class="download-btn" href="/assets/pledge_eternal_loop_android.zip" download>{t.platformAndroid}</a>
    <a class="download-btn" href="/assets/pledge_eternal_loop_mac.zip" download>{t.platformMac}</a>
    <a class="download-btn" href="/assets/pledge_eternal_loop_win.zip" download>{t.platformWin}</a>
  </div>

  <footer>{t.footer}</footer>

  <script>
    const downloadBtn = document.getElementById('download-btn');
    const downloadSection = document.getElementById('download-section');
    downloadBtn.addEventListener('click', () => {
      downloadSection.classList.toggle('show');
    });
  </script>
</body>
</html>
